{% extends 'base.html' %}
{% load static %}

{% block title_name %}UNIREAX - –û–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–∞{% endblock %}

{% block content %}
<section style="padding: 80px 20px; background: linear-gradient(135deg, #7B7FD5 0%, #86A8E7 50%, #91EAE4 100%); min-height: 100vh; display: flex; align-items: center;">
    <div style="max-width: 700px; margin: 0 auto; background: #151D49; padding: 50px; border-radius: 20px; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3); color: #FFFFFF; text-align: center;">
        
        <div style="background: #4CAF50; width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 30px; font-size: 2.5em;">
            ‚úÖ
        </div>
        
        <h1 style="font-family: 'Arial Black', sans-serif; font-size: 2.5em; color: #FFFFFF; margin-bottom: 20px;">
            –û–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–∞!
        </h1>
        
        <p style="font-size: 1.2em; color: #BFC3F7; margin-bottom: 10px;">
            –ö—É—Ä—Å <strong>"{{ course.course_name }}"</strong> —É—Å–ø–µ—à–Ω–æ –æ–ø–ª–∞—á–µ–Ω.
        </p>
        
        <p style="font-size: 1.1em; color: #BFC3F7; margin-bottom: 30px;">
            –°—É–º–º–∞: <strong>{{ course.course_price }} ‚ÇΩ</strong>
        </p>
        
        <div style="background: rgba(76, 175, 80, 0.2); padding: 20px; border-radius: 10px; margin-bottom: 30px;">
            <p style="margin: 0; color: #4CAF50; font-weight: bold;">
                üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ –∫—É—Ä—Å.
            </p>
        </div>

        <div style="background: rgba(88, 100, 241, 0.1); padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 2px dashed #5864F1;">
            <h3 style="color: #FFFFFF; margin-bottom: 20px; font-family: 'Arial Black', sans-serif;">
                üìÑ –ß–µ–∫ –æ–± –æ–ø–ª–∞—Ç–µ
            </h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: left; margin-bottom: 25px;">
                <div>
                    <p style="margin: 0 0 8px; color: #BFC3F7; font-size: 0.9em;">–ù–æ–º–µ—Ä –ø–ª–∞—Ç–µ–∂–∞:</p>
                    <p style="margin: 0; color: #FFFFFF; font-weight: bold; font-family: monospace;">{{ payment_id }}</p>
                </div>
                <div>
                    <p style="margin: 0 0 8px; color: #BFC3F7; font-size: 0.9em;">–î–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã:</p>
                    <p style="margin: 0; color: #FFFFFF; font-weight: bold;">{{ user_course.payment_date|date:"d.m.Y" }}</p>
                </div>
                <div>
                    <p style="margin: 0 0 8px; color: #BFC3F7; font-size: 0.9em;">–°–ª—É—à–∞—Ç–µ–ª—å:</p>
                    <p style="margin: 0; color: #FFFFFF; font-weight: bold;">{{ user.last_name }} {{ user.first_name }}</p>
                </div>
                <div>
                    <p style="margin: 0 0 8px; color: #BFC3F7; font-size: 0.9em;">–°—Ç–∞—Ç—É—Å:</p>
                    <p style="margin: 0; color: #4CAF50; font-weight: bold;">–û–ø–ª–∞—á–µ–Ω–æ</p>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <a href="{% url 'download_receipt' course.id payment_id %}" 
                   style="background: linear-gradient(135deg, #4CAF50, #45a049); color: white; padding: 12px 25px; border-radius: 8px; text-decoration: none; font-weight: bold; display: flex; align-items: center; gap: 8px; transition: all 0.3s;">
                    –°–∫–∞—á–∞—Ç—å —á–µ–∫ (PDF)
                </a>
                
                <button onclick="printReceipt()" 
                        style="background: linear-gradient(135deg, #5864F1, #7B7FD5); color: white; padding: 12px 25px; border-radius: 8px; text-decoration: none; font-weight: bold; border: none; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: all 0.3s;">
                    –†–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å —á–µ–∫
                </button>
            </div>
        </div>
        
        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
            <a href="{% url 'course_enroll_detail' course.id %}" 
               style="background: #5864F1; color: white; padding: 15px 30px; border-radius: 8px; text-decoration: none; font-weight: bold; transition: all 0.3s; display: flex; align-items: center; gap: 8px;">
                –ü–µ—Ä–µ–π—Ç–∏ –∫ –∫—É—Ä—Å—É
            </a>
            <a href="/" 
               style="background: #491983; color: white; padding: 15px 30px; border-radius: 8px; text-decoration: none; font-weight: bold; transition: all 0.3s; display: flex; align-items: center; gap: 8px;">
                –ù–∞ –≥–ª–∞–≤–Ω—É—é
            </a>
        </div>
        
        <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #5864F1;">
            <p style="color: #BFC3F7; font-size: 0.9em; margin: 0;">
                –ß–µ–∫ —Ç–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –≤–∞—à—É –ø–æ—á—Ç—É: <strong>{{ user.email }}</strong><br>
                –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —á–µ–∫ –¥–ª—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
            </p>
        </div>
    </div>
</section>

<style>
a:hover, button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
}

@media print {
    body * {
        visibility: hidden;
    }
    .receipt-print, .receipt-print * {
        visibility: visible;
    }
    .receipt-print {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
    }
}
</style>

<script>
function printReceipt() {
    const receiptContent = `
        <div class="receipt-print" style="font-family: Arial, sans-serif; padding: 20px; color: #333;">
            <div style="text-align: center; margin-bottom: 20px; background: #7B7FD5; color: white; padding: 20px; border-radius: 10px;">
                <h1 style="margin: 0;">UNIREAX</h1>
                <p style="margin: 5px 0 0;">–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞</p>
            </div>
            
            <h2 style="text-align: center; color: #151D49;">–ß–ï–ö –û–ë –û–ü–õ–ê–¢–ï –ö–£–†–°–ê</h2>
            
            <div style="background: #f8f9ff; padding: 15px; border-radius: 8px; margin: 20px 0;">
                <h3 style="color: #5864F1; margin-bottom: 15px;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–ª–∞—Ç–µ–∂–µ</h3>
                <table style="width: 100%; border-collapse: collapse;">
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd; font-weight: bold;">–ù–æ–º–µ—Ä –ø–ª–∞—Ç–µ–∂–∞:</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">{{ payment_id }}</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd; font-weight: bold;">–î–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã:</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">{{ user_course.payment_date|date:"d.m.Y" }}</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd; font-weight: bold;">–°—Ç–∞—Ç—É—Å:</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd; color: #4CAF50; font-weight: bold;">–û–ø–ª–∞—á–µ–Ω–æ</td>
                    </tr>
                </table>
            </div>
            
            <div style="background: #f8f9ff; padding: 15px; border-radius: 8px; margin: 20px 0;">
                <h3 style="color: #5864F1; margin-bottom: 15px;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—É—Ä—Å–µ</h3>
                <table style="width: 100%; border-collapse: collapse;">
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd; font-weight: bold;">–ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞:</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">{{ course.course_name }}</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd; font-weight: bold;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">{{ course.course_category.course_category_name }}</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd; font-weight: bold;">–°—É–º–º–∞:</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 1.2em;">{{ course.course_price }} ‚ÇΩ</td>
                    </tr>
                </table>
            </div>
            
            <div style="background: #f8f9ff; padding: 15px; border-radius: 8px; margin: 20px 0;">
                <h3 style="color: #5864F1; margin-bottom: 15px;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h3>
                <table style="width: 100%; border-collapse: collapse;">
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd; font-weight: bold;">–§–ò–û:</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">{{ user.last_name }} {{ user.first_name }}</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd; font-weight: bold;">Email:</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">{{ user.email }}</td>
                    </tr>
                </table>
            </div>
            
            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid #7B7FD5;">
                <p style="color: #666; font-size: 0.9em;">
                    –ß–µ–∫ ‚Ññ{{ payment_id }}<br>
                    –î–æ–∫—É–º–µ–Ω—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                </p>
            </div>
        </div>
    `;
    
    const printWindow = window.open('', '_blank');
    printWindow.document.write(`
        <!DOCTYPE html>
        <html>
            <head>
                <title>–ß–µ–∫ –æ–± –æ–ø–ª–∞—Ç–µ - UNIREAX</title>
                <style>
                    body { 
                        font-family: Arial, sans-serif; 
                        margin: 0; 
                        padding: 20px;
                        color: #333;
                    }
                    @media print { 
                        body { margin: 0; padding: 15px; }
                        .receipt-print { margin: 0; }
                    }
                    table { width: 100%; border-collapse: collapse; }
                    td { padding: 8px; border-bottom: 1px solid #ddd; }
                </style>
            </head>
            <body>${receiptContent}</body>
        </html>
    `);
    printWindow.document.close();
    
    setTimeout(() => {
        printWindow.focus();
        printWindow.print();
        printWindow.onafterprint = function() {
            printWindow.close();
        };
    }, 500);
}
</script>
{% endblock %}